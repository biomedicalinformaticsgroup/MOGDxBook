

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MOGDx Network Generation &mdash; Multi Omic Graph Diagnosis (MOGDx)</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=f281be69"></script>
      <script src="../../_static/scripts/sphinx-book-theme.js"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
      <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MOGDx Free" href="MOGDx_Free.html" />
    <link rel="prev" title="MOGDx &amp; PNet" href="MOGDx_PNet.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../intro.html">
            
              <img src="../../_static/mogdx.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../GettingStarted.html">Getting Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Processing_in_R.html">Processing in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Processing_in_Python.html">Processing in Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MOGDx Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Executing_MOGDx.html">Executing MOGDx</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MOGDx Model Types</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="MOGDx.html">MOGDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="MOGDx_PNet.html">MOGDx &amp; PNet</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MOGDx Network Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="MOGDx_Free.html">MOGDx Free</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Training_MOGDx.html">MOGDx Main Functions and Classes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../requirements.html">Requirements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../intro.html">Project name not set</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../intro.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">MOGDx Network Generation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Barry8197/MOGDxBook/blob/master/_build/html/_sources/MOGDx/Notebooks/MOGDx_NetGen.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="mogdx-network-generation">
<h1>MOGDx Network Generation<a class="headerlink" href="#mogdx-network-generation" title="Link to this heading">ÔÉÅ</a></h1>
<p>This is the computationally most expensive architecture, but requires the least amount of knowledge.</p>
<p>The processing step occurs within each cross validation split such that similarity features are only identified within each split.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span> 

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span> <span class="p">,</span> <span class="s1">&#39;./../&#39;</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">MAIN.utils</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">MAIN.train</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">MAIN.preprocess_functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">MAIN.GNN_MME</span><span class="w"> </span><span class="kn">import</span> <span class="n">GCN_MME</span> <span class="p">,</span> <span class="n">GSage_MME</span> <span class="p">,</span> <span class="n">GAT_MME</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">F</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dgl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dgl.dataloading</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiLayerFullNeighborSampler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">palettable</span><span class="w"> </span><span class="kn">import</span> <span class="n">wesanderson</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StratifiedKFold</span> <span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">gc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished Library Import </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished Library Import 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_input</span> <span class="o">=</span> <span class="s1">&#39;./../../data/TCGA/BRCA/raw/&#39;</span>
<span class="n">snf_net</span> <span class="o">=</span> <span class="s1">&#39;RPPA_mRNA_graph.graphml&#39;</span>
<span class="n">index_col</span> <span class="o">=</span> <span class="s1">&#39;patient&#39;</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;paper_BRCA_Subtype_PAM50&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span> <span class="k">if</span> <span class="kc">False</span> <span class="k">else</span> <span class="s1">&#39;cuda&#39;</span><span class="p">)</span> <span class="c1"># Get GPU device name, else use CPU</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using </span><span class="si">%s</span><span class="s2"> device&quot;</span> <span class="o">%</span> <span class="n">device</span><span class="p">)</span>
<span class="n">get_gpu_memory</span><span class="p">()</span>


<span class="n">datModalities</span> <span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">data_parsing</span><span class="p">(</span><span class="n">data_input</span> <span class="p">,</span> <span class="p">[</span><span class="s1">&#39;RPPA&#39;</span> <span class="p">,</span> <span class="s1">&#39;mRNA&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">target</span> <span class="p">,</span> <span class="n">index_col</span> <span class="p">,</span> <span class="n">PROCESSED</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>

<span class="n">skf</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span> <span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">skf</span><span class="p">)</span>

<span class="n">data_to_save</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">output_metrics</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_logits</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">skf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">meta</span><span class="p">))</span> <span class="p">:</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">MME_input_shapes</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">train_index</span> <span class="p">,</span> <span class="n">val_index</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">train_index</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">meta</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
    <span class="p">)</span>
    
    <span class="n">train_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">val_idx</span>   <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val_index</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">test_idx</span>  <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    
    <span class="n">all_graphs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data_to_save</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">mod</span> <span class="ow">in</span> <span class="n">datModalities</span> <span class="p">:</span> 
        <span class="n">count_mtx</span> <span class="o">=</span> <span class="n">datModalities</span><span class="p">[</span><span class="n">mod</span><span class="p">]</span>
        
        <span class="n">datMeta</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">count_mtx</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        <span class="n">datMeta</span> <span class="o">=</span> <span class="n">datMeta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">datMeta</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
        <span class="n">count_mtx</span> <span class="o">=</span> <span class="n">count_mtx</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datMeta</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        
        <span class="n">train_index_mod</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">train_idx</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">datMeta</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="n">val_index_mod</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">val_idx</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">datMeta</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">mod</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mRNA&#39;</span> <span class="p">,</span> <span class="s1">&#39;miRNA&#39;</span><span class="p">]</span> <span class="p">:</span> 
            <span class="n">pipeline</span> <span class="o">=</span> <span class="s1">&#39;DESeq&#39;</span> 
            <span class="k">if</span> <span class="n">mod</span> <span class="o">==</span> <span class="s1">&#39;mRNA&#39;</span> <span class="p">:</span> 
                <span class="n">gene_exp</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span> <span class="p">:</span> 
                <span class="n">gene_exp</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="n">pipeline</span> <span class="o">=</span> <span class="s1">&#39;LogReg&#39;</span>

        <span class="k">if</span> <span class="n">pipeline</span> <span class="o">==</span> <span class="s1">&#39;DESeq&#39;</span> <span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Performing Differential Gene Expression for Feature Selection&#39;</span><span class="p">)</span>
            
            <span class="n">count_mtx</span> <span class="p">,</span> <span class="n">datMeta</span> <span class="o">=</span> <span class="n">MAIN</span><span class="o">.</span><span class="n">preprocess_functions</span><span class="o">.</span><span class="n">data_preprocess</span><span class="p">(</span><span class="n">count_mtx</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> 
                                                        <span class="n">datMeta</span> <span class="p">,</span> <span class="n">gene_exp</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
            
            <span class="n">train_index_mod</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">train_index_mod</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">count_mtx</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="n">dds</span><span class="p">,</span> <span class="n">vsd</span><span class="p">,</span> <span class="n">top_genes</span> <span class="o">=</span> <span class="n">MAIN</span><span class="o">.</span><span class="n">preprocess_functions</span><span class="o">.</span><span class="n">DESEQ</span><span class="p">(</span><span class="n">count_mtx</span> <span class="p">,</span> <span class="n">datMeta</span> <span class="p">,</span> <span class="n">target</span> <span class="p">,</span> 
                                        <span class="n">n_genes</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">train_index</span><span class="o">=</span><span class="n">train_index_mod</span><span class="p">)</span>

            <span class="n">data_to_save</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="s1">_extracted_feats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">top_genes</span><span class="p">))</span>
            <span class="n">datExpr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vsd</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">count_mtx</span><span class="o">.</span><span class="n">index</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">count_mtx</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">pipeline</span> <span class="o">==</span> <span class="s1">&#39;LogReg&#39;</span> <span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Performing Logistic Regression for Feature Selection&#39;</span><span class="p">)</span>
            
            <span class="n">n_genes</span> <span class="o">=</span> <span class="n">count_mtx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">datExpr</span> <span class="o">=</span> <span class="n">count_mtx</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span> <span class="p">,</span> <span class="p">(</span><span class="n">count_mtx</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="c1"># remove any genes with all 0 expression</span>
            
            <span class="n">train_index_mod</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">train_index_mod</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">datExpr</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            <span class="n">val_index_mod</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">val_index_mod</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">datExpr</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
            
            <span class="n">extracted_feats</span> <span class="p">,</span> <span class="n">model</span>  <span class="o">=</span> <span class="n">MAIN</span><span class="o">.</span><span class="n">preprocess_functions</span><span class="o">.</span><span class="n">elastic_net</span><span class="p">(</span><span class="n">datExpr</span> <span class="p">,</span> <span class="n">datMeta</span> <span class="p">,</span> 
                                                         <span class="n">train_index</span><span class="o">=</span><span class="n">train_index_mod</span> <span class="p">,</span> 
                                                         <span class="n">val_index</span><span class="o">=</span><span class="n">val_index_mod</span> <span class="p">,</span>
                                                         <span class="n">l1_ratio</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

            <span class="n">data_to_save</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="s1">_extracted_feats&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">extracted_feats</span><span class="p">))</span>
            <span class="n">data_to_save</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="s1">_model&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span> <span class="p">:</span> <span class="n">model</span><span class="p">}</span>
            
            <span class="k">del</span> <span class="n">model</span>

        <span class="k">if</span> <span class="n">mod</span> <span class="ow">in</span> <span class="p">[]</span> <span class="p">:</span> 
            <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;bicorr&#39;</span>
        <span class="k">elif</span> <span class="n">mod</span> <span class="ow">in</span> <span class="p">[</span> <span class="s1">&#39;mRNA&#39;</span> <span class="p">,</span> <span class="s1">&#39;RPPA&#39;</span> <span class="p">,</span> <span class="s1">&#39;miRNA&#39;</span> <span class="p">,</span> <span class="s1">&#39;CNV&#39;</span> <span class="p">,</span> <span class="s1">&#39;DNAm&#39;</span><span class="p">]</span> <span class="p">:</span> 
            <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span>
        <span class="k">elif</span> <span class="n">mod</span> <span class="ow">in</span> <span class="p">[]</span> <span class="p">:</span> 
            <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;euclidean&#39;</span>
            
        <span class="n">datExpr</span> <span class="o">=</span> <span class="n">datExpr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datMeta</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="s1">_extracted_feats&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span> 
            <span class="n">G</span>  <span class="o">=</span> <span class="n">MAIN</span><span class="o">.</span><span class="n">preprocess_functions</span><span class="o">.</span><span class="n">knn_graph_generation</span><span class="p">(</span><span class="n">datExpr</span> <span class="p">,</span> <span class="n">datMeta</span> <span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span> <span class="p">,</span> 
                                                <span class="n">extracted_feats</span><span class="o">=</span><span class="n">data_to_save</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mod</span><span class="si">}</span><span class="s1">_extracted_feats&#39;</span><span class="p">],</span>
                                                <span class="n">node_size</span> <span class="o">=</span><span class="mi">150</span> <span class="p">,</span> <span class="n">knn</span> <span class="o">=</span> <span class="mi">15</span> <span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="n">G</span>  <span class="o">=</span> <span class="n">MAIN</span><span class="o">.</span><span class="n">preprocess_functions</span><span class="o">.</span><span class="n">knn_graph_generation</span><span class="p">(</span><span class="n">datExpr</span> <span class="p">,</span> <span class="n">datMeta</span> <span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span> <span class="p">,</span> 
                                            <span class="n">extracted_feats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_size</span> <span class="o">=</span><span class="mi">150</span> <span class="p">,</span> <span class="n">knn</span> <span class="o">=</span> <span class="mi">15</span> <span class="p">)</span>
                
        <span class="n">all_graphs</span><span class="p">[</span><span class="n">mod</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span>

        <span class="n">h</span><span class="p">[</span><span class="n">mod</span><span class="p">]</span> <span class="o">=</span> <span class="n">datExpr</span>
        <span class="n">MME_input_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datExpr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
    <span class="n">all_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">mod</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">mod</span> <span class="ow">in</span> <span class="n">h</span><span class="p">]))</span>
    <span class="n">train_index</span> <span class="o">=</span> <span class="n">indices_removal_adjust</span><span class="p">(</span><span class="n">train_index</span> <span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="n">index_col</span><span class="p">]</span> <span class="p">,</span> <span class="n">all_idx</span><span class="p">)</span>
    <span class="n">val_index</span> <span class="o">=</span> <span class="n">indices_removal_adjust</span><span class="p">(</span><span class="n">val_index</span> <span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="n">index_col</span><span class="p">]</span> <span class="p">,</span> <span class="n">all_idx</span><span class="p">)</span>
    <span class="n">test_index</span> <span class="o">=</span> <span class="n">indices_removal_adjust</span><span class="p">(</span><span class="n">test_index</span> <span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="n">index_col</span><span class="p">]</span> <span class="p">,</span> <span class="n">all_idx</span><span class="p">)</span>
    
    <span class="n">train_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">train_index</span> <span class="p">,</span> <span class="n">val_index</span><span class="p">))</span>
    
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Clearing gpu memory&#39;</span><span class="p">)</span>
    <span class="n">get_gpu_memory</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_graphs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">:</span> 
        <span class="n">full_graphs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">mod</span> <span class="p">,</span> <span class="n">graph</span> <span class="ow">in</span> <span class="n">all_graphs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span> 
            <span class="n">full_graph</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">all_idx</span><span class="p">)</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_idx</span><span class="p">)))</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">all_idx</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">all_idx</span><span class="p">)</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_pandas_adjacency</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
            <span class="n">full_graph</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">index</span> <span class="p">,</span> <span class="n">graph</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">values</span>

            <span class="n">full_graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_graph</span><span class="p">)</span>

        <span class="n">adj_snf</span> <span class="o">=</span> <span class="n">MAIN</span><span class="o">.</span><span class="n">preprocess_functions</span><span class="o">.</span><span class="n">SNF</span><span class="p">(</span><span class="n">full_graphs</span><span class="p">)</span>

        <span class="n">node_colour</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">adj_snf</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="n">wesanderson</span><span class="o">.</span><span class="n">FantasticFox2_5</span><span class="o">.</span><span class="n">hex_colors</span> <span class="p">,</span> <span class="n">rename</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">g</span>  <span class="o">=</span> <span class="n">MAIN</span><span class="o">.</span><span class="n">preprocess_functions</span><span class="o">.</span><span class="n">plot_knn_network</span><span class="p">(</span><span class="n">adj_snf</span> <span class="p">,</span> <span class="mi">15</span> <span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">adj_snf</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="p">,</span>
                                               <span class="n">node_colours</span><span class="o">=</span><span class="n">node_colour</span> <span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span> 
        <span class="n">g</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_graphs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        
    <span class="n">label</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">all_idx</span><span class="p">)]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
        
    <span class="n">h</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">merge_dfs</span> <span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">dgl</span><span class="o">.</span><span class="n">from_networkx</span><span class="p">(</span><span class="n">g</span> <span class="p">,</span> <span class="n">node_attrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span> <span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">])</span>

    <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>

    <span class="n">g</span><span class="o">.</span><span class="n">ndata</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">GCN_MME</span><span class="p">(</span><span class="n">MME_input_shapes</span> <span class="p">,</span> <span class="p">[</span><span class="mi">16</span> <span class="p">,</span> <span class="mi">16</span><span class="p">]</span> <span class="p">,</span> <span class="mi">64</span> <span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">loss_plot</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">device</span> <span class="p">,</span>  <span class="n">model</span> <span class="p">,</span> <span class="n">label</span> <span class="p">,</span> <span class="mi">2000</span> <span class="p">,</span> <span class="mf">1e-3</span> <span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loss for split </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    
    <span class="n">sampler</span> <span class="o">=</span> <span class="n">NeighborSampler</span><span class="p">(</span>
        <span class="p">[</span><span class="mi">15</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">gnnlayers</span><span class="p">))],</span>  <span class="c1"># fanout for each layer</span>
        <span class="n">prefetch_node_feats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feat&#39;</span><span class="p">],</span>
        <span class="n">prefetch_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">g</span><span class="p">,</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">test_index</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span>
        <span class="n">sampler</span><span class="p">,</span>
        <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">use_uva</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="n">test_output_metrics</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">model</span> <span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Fold : </span><span class="si">{:01d}</span><span class="s2"> | Test Accuracy = </span><span class="si">{:.4f}</span><span class="s2"> | F1 = </span><span class="si">{:.4f}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="p">,</span> <span class="n">test_output_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">test_output_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="n">test_logits</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">test_output_metrics</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">test_labels</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">test_output_metrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">output_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_output_metrics</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> 
        <span class="n">best_model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="n">best_idx</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">elif</span> <span class="n">output_metrics</span><span class="p">[</span><span class="n">best_idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">test_output_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> 
        <span class="n">best_model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="n">best_idx</span>   <span class="o">=</span> <span class="n">i</span>

    <span class="n">get_gpu_memory</span><span class="p">()</span>
    <span class="k">del</span> <span class="n">model</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Clearing gpu memory&#39;</span><span class="p">)</span>
    <span class="n">get_gpu_memory</span><span class="p">()</span>

<span class="n">test_logits</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">test_logits</span><span class="p">)</span>
<span class="n">test_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">test_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using cuda device
Total = 42.4Gb 	 Reserved = 0.0Gb 	 Allocated = 0.0Gb
StratifiedKFold(n_splits=2, random_state=None, shuffle=True)
Performing Logistic Regression for Feature Selection
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loss : 0.6042: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1000/1000 [00:02&lt;00:00, 494.66epoch/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model score : 0.877
</pre></div>
</div>
<img alt="../../_images/410ed68fc4e085b52e7797af63e257822eda0b7600bef1c6d62aa8b325b6f47c.png" src="../../_images/410ed68fc4e085b52e7797af63e257822eda0b7600bef1c6d62aa8b325b6f47c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing Differential Gene Expression for Feature Selection
Keeping 29995 genes
Removed 30665 genes
Keeping 1047 Samples
Removed 36 Samples
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting size factors...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using None as control genes, passed at DeseqDataSet initialization
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>... done in 1.23 seconds.

Fitting dispersions...
... done in 10.47 seconds.

Fitting dispersion trend curve...
... done in 0.76 seconds.

Fitting MAP dispersions...
... done in 10.90 seconds.

Fitting LFCs...
... done in 7.12 seconds.

Calculating cook&#39;s distance...
... done in 1.82 seconds.

Replacing 2948 outlier genes.

Fitting dispersions...
... done in 1.11 seconds.

Fitting MAP dispersions...
... done in 1.02 seconds.

Fitting LFCs...
... done in 1.02 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing contrastive analysis for LumA vs. Her2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.55 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs Her2
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.045843  0.109944 -0.416972   
ENSG00000000005.6     72.999641        2.364056  0.293465  8.055675   
ENSG00000000419.13  2386.496112       -0.604066  0.062602 -9.649254   
ENSG00000000457.14  1596.783158       -0.062327  0.063247 -0.985452   
ENSG00000000460.17   715.140714       -0.435593  0.080773 -5.392793   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026       -0.955682  0.240269 -3.977559   
ENSG00000288663.1     29.867524        0.627702  0.099567  6.304313   
ENSG00000288670.1    422.158728       -0.075705  0.079346 -0.954105   
ENSG00000288674.1      8.197550        0.337858  0.120301  2.808436   
ENSG00000288675.1     32.370671       -0.912699  0.116411 -7.840287   

                          pvalue          padj  
ENSG00000000003.15  6.766989e-01  7.320512e-01  
ENSG00000000005.6   7.904166e-16  9.221527e-15  
ENSG00000000419.13  4.951465e-22  1.092053e-20  
ENSG00000000457.14  3.244019e-01  3.944238e-01  
ENSG00000000460.17  6.937103e-08  3.022199e-07  
...                          ...           ...  
ENSG00000288658.1   6.962648e-05  1.878268e-04  
ENSG00000288663.1   2.894748e-10  1.756229e-09  
ENSG00000288670.1   3.400305e-01  4.104478e-01  
ENSG00000288674.1   4.978277e-03  9.501362e-03  
ENSG00000288675.1   4.495165e-15  4.869356e-14  

[29995 rows x 6 columns]
Performing contrastive analysis for LumA vs. LumB
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.71 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs LumB
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130        0.510947  0.075755   6.744707   
ENSG00000000005.6     72.999641        0.680790  0.200628   3.393294   
ENSG00000000419.13  2386.496112       -0.496193  0.043131 -11.504238   
ENSG00000000457.14  1596.783158        0.070789  0.043570   1.624718   
ENSG00000000460.17   715.140714       -0.607113  0.055622 -10.914917   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -0.808325  0.165651  -4.879702   
ENSG00000288663.1     29.867524       -0.053662  0.066356  -0.808701   
ENSG00000288670.1    422.158728       -0.228263  0.054607  -4.180137   
ENSG00000288674.1      8.197550        0.269729  0.080393   3.355135   
ENSG00000288675.1     32.370671        0.324366  0.081632   3.973538   

                          pvalue          padj  
ENSG00000000003.15  1.533361e-11  1.663405e-10  
ENSG00000000005.6   6.905757e-04  1.840247e-03  
ENSG00000000419.13  1.255933e-30  1.034937e-28  
ENSG00000000457.14  1.042227e-01  1.570698e-01  
ENSG00000000460.17  9.781815e-28  6.378381e-26  
...                          ...           ...  
ENSG00000288658.1   1.062460e-06  5.130976e-06  
ENSG00000288663.1   4.186870e-01  5.071215e-01  
ENSG00000288670.1   2.913337e-05  1.041544e-04  
ENSG00000288674.1   7.932621e-04  2.084624e-03  
ENSG00000288675.1   7.081273e-05  2.341559e-04  

[29995 rows x 6 columns]
Performing contrastive analysis for LumA vs. Normal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.58 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs Normal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.149391  0.151267 -0.987602   
ENSG00000000005.6     72.999641       -0.070272  0.400423 -0.175495   
ENSG00000000419.13  2386.496112        0.052635  0.086204  0.610591   
ENSG00000000457.14  1596.783158        0.460586  0.087118  5.286911   
ENSG00000000460.17   715.140714        0.442141  0.111457  3.966908   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026       -0.735339  0.331180 -2.220363   
ENSG00000288663.1     29.867524        0.106228  0.134479  0.789924   
ENSG00000288670.1    422.158728        0.475525  0.109506  4.342477   
ENSG00000288674.1      8.197550       -0.105403  0.159991 -0.658810   
ENSG00000288675.1     32.370671       -0.340401  0.161826 -2.103501   

                          pvalue      padj  
ENSG00000000003.15  3.233477e-01  0.443638  
ENSG00000000005.6   8.606909e-01  0.906762  
ENSG00000000419.13  5.414706e-01  0.651681  
ENSG00000000457.14  1.243991e-07  0.000002  
ENSG00000000460.17  7.281114e-05  0.000401  
...                          ...       ...  
ENSG00000288658.1   2.639415e-02  0.059055  
ENSG00000288663.1   4.295720e-01  0.548929  
ENSG00000288670.1   1.408855e-05  0.000097  
ENSG00000288674.1   5.100176e-01  0.624223  
ENSG00000288675.1   3.542197e-02  0.075375  

[29995 rows x 6 columns]
Performing contrastive analysis for LumA vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 3.07 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs Basal
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130       -0.445231  0.080360  -5.540469   
ENSG00000000005.6     72.999641        0.121811  0.212744   0.572570   
ENSG00000000419.13  2386.496112       -0.502644  0.045765 -10.983180   
ENSG00000000457.14  1596.783158        0.450413  0.046261   9.736320   
ENSG00000000460.17   715.140714       -1.016645  0.058992 -17.233544   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -1.948089  0.174996 -11.132162   
ENSG00000288663.1     29.867524        0.589213  0.072151   8.166402   
ENSG00000288670.1    422.158728        0.042231  0.058005   0.728061   
ENSG00000288674.1      8.197550        0.081888  0.085157   0.961606   
ENSG00000288675.1     32.370671       -0.328268  0.085826  -3.824821   

                          pvalue          padj  
ENSG00000000003.15  3.016618e-08  5.818872e-08  
ENSG00000000005.6   5.669360e-01  6.009346e-01  
ENSG00000000419.13  4.604242e-28  2.082392e-27  
ENSG00000000457.14  2.110588e-22  7.768694e-22  
ENSG00000000460.17  1.487504e-66  1.983009e-65  
...                          ...           ...  
ENSG00000288658.1   8.748769e-29  4.064106e-28  
ENSG00000288663.1   3.177226e-16  9.097937e-16  
ENSG00000288670.1   4.665759e-01  5.029268e-01  
ENSG00000288674.1   3.362475e-01  3.704861e-01  
ENSG00000288675.1   1.308669e-04  2.016518e-04  

[29995 rows x 6 columns]
Performing contrastive analysis for Her2 vs. LumB
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.57 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Her2 vs LumB
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130        0.556791  0.121299  4.590230   
ENSG00000000005.6     72.999641       -1.683266  0.323369 -5.205406   
ENSG00000000419.13  2386.496112        0.107873  0.069059  1.562059   
ENSG00000000457.14  1596.783158        0.133116  0.069775  1.907792   
ENSG00000000460.17   715.140714       -0.171520  0.089082 -1.925423   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026        0.147357  0.264721  0.556650   
ENSG00000288663.1     29.867524       -0.681364  0.109132 -6.243507   
ENSG00000288670.1    422.158728       -0.152558  0.087504 -1.743435   
ENSG00000288674.1      8.197550       -0.068130  0.132312 -0.514919   
ENSG00000288675.1     32.370671        1.237065  0.128962  9.592483   

                          pvalue          padj  
ENSG00000000003.15  4.427577e-06  2.483732e-05  
ENSG00000000005.6   1.935725e-07  1.438248e-06  
ENSG00000000419.13  1.182741e-01  1.871212e-01  
ENSG00000000457.14  5.641806e-02  1.010847e-01  
ENSG00000000460.17  5.417652e-02  9.782234e-02  
...                          ...           ...  
ENSG00000288658.1   5.777668e-01  6.693490e-01  
ENSG00000288663.1   4.278680e-10  5.115145e-09  
ENSG00000288670.1   8.125771e-02  1.371595e-01  
ENSG00000288674.1   6.066099e-01  6.935602e-01  
ENSG00000288675.1   8.599064e-22  4.931720e-20  

[29995 rows x 6 columns]
Performing contrastive analysis for Her2 vs. Normal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.29 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Her2 vs Normal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.103548  0.178483 -0.580154   
ENSG00000000005.6     72.999641       -2.434328  0.473977 -5.135963   
ENSG00000000419.13  2386.496112        0.656701  0.101685  6.458198   
ENSG00000000457.14  1596.783158        0.522913  0.102761  5.088644   
ENSG00000000460.17   715.140714        0.877735  0.131394  6.680153   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026        0.220343  0.390278  0.564578   
ENSG00000288663.1     29.867524       -0.521474  0.159972 -3.259780   
ENSG00000288670.1    422.158728        0.551230  0.129099  4.269815   
ENSG00000288674.1      8.197550       -0.443262  0.191417 -2.315687   
ENSG00000288675.1     32.370671        0.572297  0.190145  3.009796   

                          pvalue          padj  
ENSG00000000003.15  5.618107e-01  6.612585e-01  
ENSG00000000005.6   2.807025e-07  2.722169e-06  
ENSG00000000419.13  1.059569e-10  2.622258e-09  
ENSG00000000457.14  3.606320e-07  3.381419e-06  
ENSG00000000460.17  2.386925e-11  7.074684e-10  
...                          ...           ...  
ENSG00000288658.1   5.723605e-01  6.706232e-01  
ENSG00000288663.1   1.114985e-03  3.756484e-03  
ENSG00000288670.1   1.956349e-05  1.138767e-04  
ENSG00000288674.1   2.057536e-02  4.536925e-02  
ENSG00000288675.1   2.614234e-03  7.828087e-03  

[29995 rows x 6 columns]
Performing contrastive analysis for Her2 vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.21 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Her2 vs Basal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.399387  0.124227 -3.214986   
ENSG00000000005.6     72.999641       -2.242245  0.331022 -6.773697   
ENSG00000000419.13  2386.496112        0.101422  0.070733  1.433868   
ENSG00000000457.14  1596.783158        0.512741  0.071486  7.172564   
ENSG00000000460.17   715.140714       -0.581052  0.091224 -6.369509   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026       -0.992407  0.270668 -3.666515   
ENSG00000288663.1     29.867524       -0.038489  0.112749 -0.341369   
ENSG00000288670.1    422.158728        0.117936  0.089665  1.315300   
ENSG00000288674.1      8.197550       -0.255971  0.135260 -1.892439   
ENSG00000288675.1     32.370671        0.584431  0.131657  4.439052   

                          pvalue          padj  
ENSG00000000003.15  1.304511e-03  2.998375e-03  
ENSG00000000005.6   1.255320e-11  8.772910e-11  
ENSG00000000419.13  1.516099e-01  2.123529e-01  
ENSG00000000457.14  7.360624e-13  5.828456e-12  
ENSG00000000460.17  1.896341e-10  1.165828e-09  
...                          ...           ...  
ENSG00000288658.1   2.458782e-04  6.493324e-04  
ENSG00000288663.1   7.328255e-01  7.904312e-01  
ENSG00000288670.1   1.884089e-01  2.559486e-01  
ENSG00000288674.1   5.843248e-02  9.229501e-02  
ENSG00000288675.1   9.035578e-06  3.005347e-05  

[29995 rows x 6 columns]
Performing contrastive analysis for LumB vs. Normal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.46 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumB vs Normal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.660339  0.159710 -4.134599   
ENSG00000000005.6     72.999641       -0.751062  0.422829 -1.776279   
ENSG00000000419.13  2386.496112        0.548828  0.091000  6.031049   
ENSG00000000457.14  1596.783158        0.389797  0.091967  4.238455   
ENSG00000000460.17   715.140714        1.049255  0.117618  8.920861   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026        0.072986  0.349326  0.208934   
ENSG00000288663.1     29.867524        0.159890  0.141706  1.128321   
ENSG00000288670.1    422.158728        0.703788  0.115554  6.090571   
ENSG00000288674.1      8.197550       -0.375132  0.169207 -2.216998   
ENSG00000288675.1     32.370671       -0.664767  0.171077 -3.885788   

                          pvalue          padj  
ENSG00000000003.15  3.555757e-05  1.318795e-04  
ENSG00000000005.6   7.568690e-02  1.186675e-01  
ENSG00000000419.13  1.628993e-09  1.457548e-08  
ENSG00000000457.14  2.250635e-05  8.702824e-05  
ENSG00000000460.17  4.626757e-19  2.505046e-17  
...                          ...           ...  
ENSG00000288658.1   8.345000e-01  8.730974e-01  
ENSG00000288663.1   2.591845e-01  3.374382e-01  
ENSG00000288670.1   1.125090e-09  1.042542e-08  
ENSG00000288674.1   2.662322e-02  4.801079e-02  
ENSG00000288675.1   1.019985e-04  3.432181e-04  

[29995 rows x 6 columns]
Performing contrastive analysis for LumB vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.19 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumB vs Basal
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130       -0.956178  0.095308 -10.032555   
ENSG00000000005.6     72.999641       -0.558979  0.252400  -2.214654   
ENSG00000000419.13  2386.496112       -0.006451  0.054263  -0.118890   
ENSG00000000457.14  1596.783158        0.379624  0.054849   6.921272   
ENSG00000000460.17   715.140714       -0.409531  0.069938  -5.855629   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -1.139764  0.207297  -5.498215   
ENSG00000288663.1     29.867524        0.642875  0.084864   7.575379   
ENSG00000288670.1    422.158728        0.270494  0.068745   3.934774   
ENSG00000288674.1      8.197550       -0.187841  0.101419  -1.852129   
ENSG00000288675.1     32.370671       -0.652634  0.102204  -6.385618   

                          pvalue          padj  
ENSG00000000003.15  1.096424e-23  6.605189e-23  
ENSG00000000005.6   2.678385e-02  3.592073e-02  
ENSG00000000419.13  9.053625e-01  9.182818e-01  
ENSG00000000457.14  4.476050e-12  1.394755e-11  
ENSG00000000460.17  4.752078e-09  1.200628e-08  
...                          ...           ...  
ENSG00000288658.1   3.836546e-08  9.064050e-08  
ENSG00000288663.1   3.580819e-14  1.268982e-13  
ENSG00000288670.1   8.327492e-05  1.475736e-04  
ENSG00000288674.1   6.400724e-02  8.153584e-02  
ENSG00000288675.1   1.707070e-10  4.801086e-10  

[29995 rows x 6 columns]
Performing contrastive analysis for Normal vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.34 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Normal vs Basal
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130       -0.295840  0.161945  -1.826789   
ENSG00000000005.6     72.999641        0.192083  0.428710   0.448048   
ENSG00000000419.13  2386.496112       -0.555279  0.092278  -6.017474   
ENSG00000000457.14  1596.783158       -0.010172  0.093272  -0.109060   
ENSG00000000460.17   715.140714       -1.458786  0.119249 -12.233141   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -1.212750  0.353853  -3.427268   
ENSG00000288663.1     29.867524        0.482985  0.144510   3.342218   
ENSG00000288670.1    422.158728       -0.433294  0.117198  -3.697105   
ENSG00000288674.1      8.197550        0.187291  0.171522   1.091936   
ENSG00000288675.1     32.370671        0.012134  0.173117   0.070089   

                          pvalue          padj  
ENSG00000000003.15  6.773147e-02  1.155634e-01  
ENSG00000000005.6   6.541185e-01  7.328111e-01  
ENSG00000000419.13  1.771600e-09  1.772487e-08  
ENSG00000000457.14  9.131548e-01  9.377274e-01  
ENSG00000000460.17  2.067839e-34  5.743039e-32  
...                          ...           ...  
ENSG00000288658.1   6.096865e-04  1.915328e-03  
ENSG00000288663.1   8.311184e-04  2.519648e-03  
ENSG00000288670.1   2.180718e-04  7.638751e-04  
ENSG00000288674.1   2.748612e-01  3.696571e-01  
ENSG00000288675.1   9.441229e-01  9.600946e-01  

[29995 rows x 6 columns]
Fit type used for VST : parametric
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting dispersions...
... done in 9.30 seconds.
</pre></div>
</div>
<img alt="../../_images/cc2b1f004fd9f248d5b4697e2b77ee67a43145fe5279aee22b5b584c4cf3d3a8.png" src="../../_images/cc2b1f004fd9f248d5b4697e2b77ee67a43145fe5279aee22b5b584c4cf3d3a8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Clearing gpu memory
Total = 42.4Gb 	 Reserved = 0.0Gb 	 Allocated = 0.0Gb
</pre></div>
</div>
<img alt="../../_images/5642c18539af1ee23067da0be3b8628dda73c583af31028404d9f045e3e28539.png" src="../../_images/5642c18539af1ee23067da0be3b8628dda73c583af31028404d9f045e3e28539.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GCN_MME(
  (encoder_dims): ModuleList(
    (0): Encoder(
      (encoder): ModuleList(
        (0): Linear(in_features=464, out_features=500, bias=True)
        (1): Linear(in_features=500, out_features=16, bias=True)
      )
      (norm): ModuleList(
        (0): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=16, out_features=64, bias=True)
      )
      (drop): Dropout(p=0.5, inplace=False)
    )
    (1): Encoder(
      (encoder): ModuleList(
        (0): Linear(in_features=29995, out_features=500, bias=True)
        (1): Linear(in_features=500, out_features=16, bias=True)
      )
      (norm): ModuleList(
        (0): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=16, out_features=64, bias=True)
      )
      (drop): Dropout(p=0.5, inplace=False)
    )
  )
  (gnnlayers): ModuleList(
    (0): GraphConv(in=64, out=32, normalization=both, activation=None)
    (1): GraphConv(in=32, out=5, normalization=both, activation=None)
  )
  (batch_norms): ModuleList(
    (0): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (drop): Dropout(p=0.5, inplace=False)
)
Graph(num_nodes=1076, num_edges=18340,
      ndata_schemes={&#39;idx&#39;: Scheme(shape=(), dtype=torch.int64), &#39;label&#39;: Scheme(shape=(5,), dtype=torch.int64), &#39;feat&#39;: Scheme(shape=(30459,), dtype=torch.float32)}
      edata_schemes={})
Epoch 00000 | Loss 1.8291 | Train Acc. 0.2230 | 
Epoch 00005 | Loss 0.6409 | Train Acc. 0.7974 | 
Epoch 00010 | Loss 0.5584 | Train Acc. 0.8309 | 
Epoch 00015 | Loss 0.4914 | Train Acc. 0.8383 | 
Epoch 00020 | Loss 0.4561 | Train Acc. 0.8457 | 
Epoch 00025 | Loss 0.4449 | Train Acc. 0.8327 | 
Epoch 00030 | Loss 0.4324 | Train Acc. 0.8309 | 
Epoch 00035 | Loss 0.3926 | Train Acc. 0.8494 | 
Epoch 00040 | Loss 0.4163 | Train Acc. 0.8569 | 
Epoch 00045 | Loss 0.3781 | Train Acc. 0.8532 | 
Epoch 00050 | Loss 0.3679 | Train Acc. 0.8550 | 
Epoch 00055 | Loss 0.3676 | Train Acc. 0.8439 | 
Epoch 00060 | Loss 0.3519 | Train Acc. 0.8662 | 
Epoch 00065 | Loss 0.3529 | Train Acc. 0.8643 | 
Epoch 00070 | Loss 0.3619 | Train Acc. 0.8643 | 
Epoch 00075 | Loss 0.3438 | Train Acc. 0.8662 | 
Epoch 00080 | Loss 0.3323 | Train Acc. 0.8717 | 
Epoch 00085 | Loss 0.3296 | Train Acc. 0.8755 | 
Epoch 00090 | Loss 0.3310 | Train Acc. 0.8736 | 
Epoch 00095 | Loss 0.3275 | Train Acc. 0.8736 | 
Epoch 00100 | Loss 0.3142 | Train Acc. 0.8717 | 
Epoch 00105 | Loss 0.3110 | Train Acc. 0.8792 | 
Epoch 00110 | Loss 0.3265 | Train Acc. 0.8662 | 
Epoch 00115 | Loss 0.3329 | Train Acc. 0.8625 | 
Epoch 00120 | Loss 0.3043 | Train Acc. 0.8866 | 
Epoch 00125 | Loss 0.3079 | Train Acc. 0.8792 | 
Epoch 00130 | Loss 0.2987 | Train Acc. 0.8810 | 
Epoch 00135 | Loss 0.3162 | Train Acc. 0.8773 | 
Epoch 00140 | Loss 0.3199 | Train Acc. 0.8755 | 
Epoch 00145 | Loss 0.3026 | Train Acc. 0.8792 | 
Epoch 00150 | Loss 0.3020 | Train Acc. 0.8755 | 
Epoch 00155 | Loss 0.3111 | Train Acc. 0.8773 | 
Epoch 00160 | Loss 0.3019 | Train Acc. 0.8866 | 
Epoch 00165 | Loss 0.3063 | Train Acc. 0.8903 | 
Epoch 00170 | Loss 0.2964 | Train Acc. 0.8773 | 
Epoch 00175 | Loss 0.2888 | Train Acc. 0.8885 | 
Epoch 00180 | Loss 0.2945 | Train Acc. 0.8922 | 
Epoch 00185 | Loss 0.2923 | Train Acc. 0.8996 | 
Epoch 00190 | Loss 0.2908 | Train Acc. 0.8922 | 
Epoch 00195 | Loss 0.2977 | Train Acc. 0.8903 | 
Epoch 00200 | Loss 0.2945 | Train Acc. 0.8848 | 
Epoch 00205 | Loss 0.2964 | Train Acc. 0.8810 | 
Epoch 00210 | Loss 0.2782 | Train Acc. 0.8996 | 
Epoch 00215 | Loss 0.2982 | Train Acc. 0.8680 | 
Epoch 00220 | Loss 0.2880 | Train Acc. 0.8848 | 
Epoch 00225 | Loss 0.2932 | Train Acc. 0.8866 | 
Epoch 00230 | Loss 0.2993 | Train Acc. 0.8773 | 
Epoch 00235 | Loss 0.2817 | Train Acc. 0.8978 | 
Epoch 00240 | Loss 0.2857 | Train Acc. 0.8866 | 
Epoch 00245 | Loss 0.2928 | Train Acc. 0.8941 | 
Epoch 00250 | Loss 0.2903 | Train Acc. 0.8810 | 
Epoch 00255 | Loss 0.2977 | Train Acc. 0.8866 | 
Epoch 00260 | Loss 0.3070 | Train Acc. 0.8792 | 
Epoch 00265 | Loss 0.3077 | Train Acc. 0.8922 | 
Epoch 00270 | Loss 0.2879 | Train Acc. 0.8885 | 
Epoch 00275 | Loss 0.2780 | Train Acc. 0.8829 | 
Epoch 00280 | Loss 0.2829 | Train Acc. 0.8829 | 
Epoch 00285 | Loss 0.2986 | Train Acc. 0.8755 | 
Epoch 00290 | Loss 0.2913 | Train Acc. 0.8922 | 
Epoch 00295 | Loss 0.2870 | Train Acc. 0.8996 | 
Epoch 00300 | Loss 0.2759 | Train Acc. 0.8866 | 
Epoch 00305 | Loss 0.2921 | Train Acc. 0.8903 | 
Epoch 00310 | Loss 0.2996 | Train Acc. 0.8941 | 
Epoch 00315 | Loss 0.2841 | Train Acc. 0.8885 | 
Epoch 00320 | Loss 0.3018 | Train Acc. 0.8903 | 
Epoch 00325 | Loss 0.2918 | Train Acc. 0.8903 | 
Epoch 00330 | Loss 0.2901 | Train Acc. 0.8829 | 
Epoch 00335 | Loss 0.2753 | Train Acc. 0.8866 | 
Epoch 00340 | Loss 0.2861 | Train Acc. 0.8885 | 
Epoch 00345 | Loss 0.2779 | Train Acc. 0.8922 | 
Epoch 00350 | Loss 0.2898 | Train Acc. 0.8922 | 
Epoch 00355 | Loss 0.2846 | Train Acc. 0.9015 | 
Epoch 00360 | Loss 0.2750 | Train Acc. 0.8959 | 
Epoch 00365 | Loss 0.2774 | Train Acc. 0.8885 | 
Epoch 00370 | Loss 0.2826 | Train Acc. 0.8885 | 
Epoch 00375 | Loss 0.2694 | Train Acc. 0.8922 | 
Epoch 00380 | Loss 0.3013 | Train Acc. 0.8773 | 
Epoch 00385 | Loss 0.2818 | Train Acc. 0.8903 | 
Epoch 00390 | Loss 0.2829 | Train Acc. 0.8866 | 
Epoch 00395 | Loss 0.2822 | Train Acc. 0.8885 | 
Epoch 00400 | Loss 0.2829 | Train Acc. 0.8903 | 
Epoch 00405 | Loss 0.2885 | Train Acc. 0.8848 | 
Epoch 00410 | Loss 0.2770 | Train Acc. 0.8922 | 
Epoch 00415 | Loss 0.2764 | Train Acc. 0.8959 | 
Epoch 00420 | Loss 0.2841 | Train Acc. 0.8885 | 
Epoch 00425 | Loss 0.2682 | Train Acc. 0.8978 | 
Epoch 00430 | Loss 0.2932 | Train Acc. 0.8773 | 
Epoch 00435 | Loss 0.2790 | Train Acc. 0.8922 | 
Epoch 00440 | Loss 0.2649 | Train Acc. 0.8848 | 
Epoch 00445 | Loss 0.3039 | Train Acc. 0.8866 | 
Epoch 00450 | Loss 0.2829 | Train Acc. 0.8829 | 
Epoch 00455 | Loss 0.2901 | Train Acc. 0.8829 | 
Epoch 00460 | Loss 0.2908 | Train Acc. 0.8792 | 
Epoch 00465 | Loss 0.2677 | Train Acc. 0.8941 | 
Epoch 00470 | Loss 0.2917 | Train Acc. 0.8978 | 
Early stopping! No improvement for 100 consecutive epochs.
</pre></div>
</div>
<img alt="../../_images/0b3bff19087c564d8b6db6d361aa9132cf58aeec7956e576034c2234e337836a.png" src="../../_images/0b3bff19087c564d8b6db6d361aa9132cf58aeec7956e576034c2234e337836a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fold : 1 | Test Accuracy = 0.8364 | F1 = 0.8039 
Total = 42.4Gb 	 Reserved = 0.6Gb 	 Allocated = 0.3Gb
Clearing gpu memory
Total = 42.4Gb 	 Reserved = 0.3Gb 	 Allocated = 0.3Gb
Performing Logistic Regression for Feature Selection
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loss : 0.6041: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1000/1000 [00:02&lt;00:00, 406.47epoch/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model score : 0.877
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../_images/b23457bdc33b843a183fc1e6a89ab127b74a065e9015ceacc8bd3b13d83c8719.png" src="../../_images/b23457bdc33b843a183fc1e6a89ab127b74a065e9015ceacc8bd3b13d83c8719.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing Differential Gene Expression for Feature Selection
Keeping 29995 genes
Removed 30665 genes
Keeping 1047 Samples
Removed 36 Samples
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting size factors...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using None as control genes, passed at DeseqDataSet initialization
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>... done in 1.19 seconds.

Fitting dispersions...
... done in 10.30 seconds.

Fitting dispersion trend curve...
... done in 0.59 seconds.

Fitting MAP dispersions...
... done in 11.29 seconds.

Fitting LFCs...
... done in 6.66 seconds.

Calculating cook&#39;s distance...
... done in 2.13 seconds.

Replacing 2948 outlier genes.

Fitting dispersions...
... done in 1.10 seconds.

Fitting MAP dispersions...
... done in 1.05 seconds.

Fitting LFCs...
... done in 1.00 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing contrastive analysis for LumA vs. Her2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.68 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs Her2
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.045843  0.109944 -0.416972   
ENSG00000000005.6     72.999641        2.364056  0.293465  8.055675   
ENSG00000000419.13  2386.496112       -0.604066  0.062602 -9.649254   
ENSG00000000457.14  1596.783158       -0.062327  0.063247 -0.985452   
ENSG00000000460.17   715.140714       -0.435593  0.080773 -5.392793   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026       -0.955682  0.240269 -3.977559   
ENSG00000288663.1     29.867524        0.627702  0.099567  6.304313   
ENSG00000288670.1    422.158728       -0.075705  0.079346 -0.954105   
ENSG00000288674.1      8.197550        0.337858  0.120301  2.808436   
ENSG00000288675.1     32.370671       -0.912699  0.116411 -7.840287   

                          pvalue          padj  
ENSG00000000003.15  6.766989e-01  7.320512e-01  
ENSG00000000005.6   7.904166e-16  9.221527e-15  
ENSG00000000419.13  4.951465e-22  1.092053e-20  
ENSG00000000457.14  3.244019e-01  3.944238e-01  
ENSG00000000460.17  6.937103e-08  3.022199e-07  
...                          ...           ...  
ENSG00000288658.1   6.962648e-05  1.878268e-04  
ENSG00000288663.1   2.894748e-10  1.756229e-09  
ENSG00000288670.1   3.400305e-01  4.104478e-01  
ENSG00000288674.1   4.978277e-03  9.501362e-03  
ENSG00000288675.1   4.495165e-15  4.869356e-14  

[29995 rows x 6 columns]
Performing contrastive analysis for LumA vs. LumB
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.66 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs LumB
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130        0.510947  0.075755   6.744707   
ENSG00000000005.6     72.999641        0.680790  0.200628   3.393294   
ENSG00000000419.13  2386.496112       -0.496193  0.043131 -11.504238   
ENSG00000000457.14  1596.783158        0.070789  0.043570   1.624718   
ENSG00000000460.17   715.140714       -0.607113  0.055622 -10.914917   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -0.808325  0.165651  -4.879702   
ENSG00000288663.1     29.867524       -0.053662  0.066356  -0.808701   
ENSG00000288670.1    422.158728       -0.228263  0.054607  -4.180137   
ENSG00000288674.1      8.197550        0.269729  0.080393   3.355135   
ENSG00000288675.1     32.370671        0.324366  0.081632   3.973538   

                          pvalue          padj  
ENSG00000000003.15  1.533361e-11  1.663405e-10  
ENSG00000000005.6   6.905757e-04  1.840247e-03  
ENSG00000000419.13  1.255933e-30  1.034937e-28  
ENSG00000000457.14  1.042227e-01  1.570698e-01  
ENSG00000000460.17  9.781815e-28  6.378381e-26  
...                          ...           ...  
ENSG00000288658.1   1.062460e-06  5.130976e-06  
ENSG00000288663.1   4.186870e-01  5.071215e-01  
ENSG00000288670.1   2.913337e-05  1.041544e-04  
ENSG00000288674.1   7.932621e-04  2.084624e-03  
ENSG00000288675.1   7.081273e-05  2.341559e-04  

[29995 rows x 6 columns]
Performing contrastive analysis for LumA vs. Normal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.08 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs Normal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.149391  0.151267 -0.987602   
ENSG00000000005.6     72.999641       -0.070272  0.400423 -0.175495   
ENSG00000000419.13  2386.496112        0.052635  0.086204  0.610591   
ENSG00000000457.14  1596.783158        0.460586  0.087118  5.286911   
ENSG00000000460.17   715.140714        0.442141  0.111457  3.966908   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026       -0.735339  0.331180 -2.220363   
ENSG00000288663.1     29.867524        0.106228  0.134479  0.789924   
ENSG00000288670.1    422.158728        0.475525  0.109506  4.342477   
ENSG00000288674.1      8.197550       -0.105403  0.159991 -0.658810   
ENSG00000288675.1     32.370671       -0.340401  0.161826 -2.103501   

                          pvalue      padj  
ENSG00000000003.15  3.233477e-01  0.443638  
ENSG00000000005.6   8.606909e-01  0.906762  
ENSG00000000419.13  5.414706e-01  0.651681  
ENSG00000000457.14  1.243991e-07  0.000002  
ENSG00000000460.17  7.281114e-05  0.000401  
...                          ...       ...  
ENSG00000288658.1   2.639415e-02  0.059055  
ENSG00000288663.1   4.295720e-01  0.548929  
ENSG00000288670.1   1.408855e-05  0.000097  
ENSG00000288674.1   5.100176e-01  0.624223  
ENSG00000288675.1   3.542197e-02  0.075375  

[29995 rows x 6 columns]
Performing contrastive analysis for LumA vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.11 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumA vs Basal
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130       -0.445231  0.080360  -5.540469   
ENSG00000000005.6     72.999641        0.121811  0.212744   0.572570   
ENSG00000000419.13  2386.496112       -0.502644  0.045765 -10.983180   
ENSG00000000457.14  1596.783158        0.450413  0.046261   9.736320   
ENSG00000000460.17   715.140714       -1.016645  0.058992 -17.233544   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -1.948089  0.174996 -11.132162   
ENSG00000288663.1     29.867524        0.589213  0.072151   8.166402   
ENSG00000288670.1    422.158728        0.042231  0.058005   0.728061   
ENSG00000288674.1      8.197550        0.081888  0.085157   0.961606   
ENSG00000288675.1     32.370671       -0.328268  0.085826  -3.824821   

                          pvalue          padj  
ENSG00000000003.15  3.016618e-08  5.818872e-08  
ENSG00000000005.6   5.669360e-01  6.009346e-01  
ENSG00000000419.13  4.604242e-28  2.082392e-27  
ENSG00000000457.14  2.110588e-22  7.768694e-22  
ENSG00000000460.17  1.487504e-66  1.983009e-65  
...                          ...           ...  
ENSG00000288658.1   8.748769e-29  4.064106e-28  
ENSG00000288663.1   3.177226e-16  9.097937e-16  
ENSG00000288670.1   4.665759e-01  5.029268e-01  
ENSG00000288674.1   3.362475e-01  3.704861e-01  
ENSG00000288675.1   1.308669e-04  2.016518e-04  

[29995 rows x 6 columns]
Performing contrastive analysis for Her2 vs. LumB
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.42 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Her2 vs LumB
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130        0.556791  0.121299  4.590230   
ENSG00000000005.6     72.999641       -1.683266  0.323369 -5.205406   
ENSG00000000419.13  2386.496112        0.107873  0.069059  1.562059   
ENSG00000000457.14  1596.783158        0.133116  0.069775  1.907792   
ENSG00000000460.17   715.140714       -0.171520  0.089082 -1.925423   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026        0.147357  0.264721  0.556650   
ENSG00000288663.1     29.867524       -0.681364  0.109132 -6.243507   
ENSG00000288670.1    422.158728       -0.152558  0.087504 -1.743435   
ENSG00000288674.1      8.197550       -0.068130  0.132312 -0.514919   
ENSG00000288675.1     32.370671        1.237065  0.128962  9.592483   

                          pvalue          padj  
ENSG00000000003.15  4.427577e-06  2.483732e-05  
ENSG00000000005.6   1.935725e-07  1.438248e-06  
ENSG00000000419.13  1.182741e-01  1.871212e-01  
ENSG00000000457.14  5.641806e-02  1.010847e-01  
ENSG00000000460.17  5.417652e-02  9.782234e-02  
...                          ...           ...  
ENSG00000288658.1   5.777668e-01  6.693490e-01  
ENSG00000288663.1   4.278680e-10  5.115145e-09  
ENSG00000288670.1   8.125771e-02  1.371595e-01  
ENSG00000288674.1   6.066099e-01  6.935602e-01  
ENSG00000288675.1   8.599064e-22  4.931720e-20  

[29995 rows x 6 columns]
Performing contrastive analysis for Her2 vs. Normal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.60 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Her2 vs Normal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.103548  0.178483 -0.580154   
ENSG00000000005.6     72.999641       -2.434328  0.473977 -5.135963   
ENSG00000000419.13  2386.496112        0.656701  0.101685  6.458198   
ENSG00000000457.14  1596.783158        0.522913  0.102761  5.088644   
ENSG00000000460.17   715.140714        0.877735  0.131394  6.680153   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026        0.220343  0.390278  0.564578   
ENSG00000288663.1     29.867524       -0.521474  0.159972 -3.259780   
ENSG00000288670.1    422.158728        0.551230  0.129099  4.269815   
ENSG00000288674.1      8.197550       -0.443262  0.191417 -2.315687   
ENSG00000288675.1     32.370671        0.572297  0.190145  3.009796   

                          pvalue          padj  
ENSG00000000003.15  5.618107e-01  6.612585e-01  
ENSG00000000005.6   2.807025e-07  2.722169e-06  
ENSG00000000419.13  1.059569e-10  2.622258e-09  
ENSG00000000457.14  3.606320e-07  3.381419e-06  
ENSG00000000460.17  2.386925e-11  7.074684e-10  
...                          ...           ...  
ENSG00000288658.1   5.723605e-01  6.706232e-01  
ENSG00000288663.1   1.114985e-03  3.756484e-03  
ENSG00000288670.1   1.956349e-05  1.138767e-04  
ENSG00000288674.1   2.057536e-02  4.536925e-02  
ENSG00000288675.1   2.614234e-03  7.828087e-03  

[29995 rows x 6 columns]
Performing contrastive analysis for Her2 vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.37 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Her2 vs Basal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.399387  0.124227 -3.214986   
ENSG00000000005.6     72.999641       -2.242245  0.331022 -6.773697   
ENSG00000000419.13  2386.496112        0.101422  0.070733  1.433868   
ENSG00000000457.14  1596.783158        0.512741  0.071486  7.172564   
ENSG00000000460.17   715.140714       -0.581052  0.091224 -6.369509   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026       -0.992407  0.270668 -3.666515   
ENSG00000288663.1     29.867524       -0.038489  0.112749 -0.341369   
ENSG00000288670.1    422.158728        0.117936  0.089665  1.315300   
ENSG00000288674.1      8.197550       -0.255971  0.135260 -1.892439   
ENSG00000288675.1     32.370671        0.584431  0.131657  4.439052   

                          pvalue          padj  
ENSG00000000003.15  1.304511e-03  2.998375e-03  
ENSG00000000005.6   1.255320e-11  8.772910e-11  
ENSG00000000419.13  1.516099e-01  2.123529e-01  
ENSG00000000457.14  7.360624e-13  5.828456e-12  
ENSG00000000460.17  1.896341e-10  1.165828e-09  
...                          ...           ...  
ENSG00000288658.1   2.458782e-04  6.493324e-04  
ENSG00000288663.1   7.328255e-01  7.904312e-01  
ENSG00000288670.1   1.884089e-01  2.559486e-01  
ENSG00000288674.1   5.843248e-02  9.229501e-02  
ENSG00000288675.1   9.035578e-06  3.005347e-05  

[29995 rows x 6 columns]
Performing contrastive analysis for LumB vs. Normal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.62 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumB vs Normal
                       baseMean  log2FoldChange     lfcSE      stat  \
ENSG00000000003.15  3087.392130       -0.660339  0.159710 -4.134599   
ENSG00000000005.6     72.999641       -0.751062  0.422829 -1.776279   
ENSG00000000419.13  2386.496112        0.548828  0.091000  6.031049   
ENSG00000000457.14  1596.783158        0.389797  0.091967  4.238455   
ENSG00000000460.17   715.140714        1.049255  0.117618  8.920861   
...                         ...             ...       ...       ...   
ENSG00000288658.1     22.532026        0.072986  0.349326  0.208934   
ENSG00000288663.1     29.867524        0.159890  0.141706  1.128321   
ENSG00000288670.1    422.158728        0.703788  0.115554  6.090571   
ENSG00000288674.1      8.197550       -0.375132  0.169207 -2.216998   
ENSG00000288675.1     32.370671       -0.664767  0.171077 -3.885788   

                          pvalue          padj  
ENSG00000000003.15  3.555757e-05  1.318795e-04  
ENSG00000000005.6   7.568690e-02  1.186675e-01  
ENSG00000000419.13  1.628993e-09  1.457548e-08  
ENSG00000000457.14  2.250635e-05  8.702824e-05  
ENSG00000000460.17  4.626757e-19  2.505046e-17  
...                          ...           ...  
ENSG00000288658.1   8.345000e-01  8.730974e-01  
ENSG00000288663.1   2.591845e-01  3.374382e-01  
ENSG00000288670.1   1.125090e-09  1.042542e-08  
ENSG00000288674.1   2.662322e-02  4.801079e-02  
ENSG00000288675.1   1.019985e-04  3.432181e-04  

[29995 rows x 6 columns]
Performing contrastive analysis for LumB vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.88 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 LumB vs Basal
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130       -0.956178  0.095308 -10.032555   
ENSG00000000005.6     72.999641       -0.558979  0.252400  -2.214654   
ENSG00000000419.13  2386.496112       -0.006451  0.054263  -0.118890   
ENSG00000000457.14  1596.783158        0.379624  0.054849   6.921272   
ENSG00000000460.17   715.140714       -0.409531  0.069938  -5.855629   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -1.139764  0.207297  -5.498215   
ENSG00000288663.1     29.867524        0.642875  0.084864   7.575379   
ENSG00000288670.1    422.158728        0.270494  0.068745   3.934774   
ENSG00000288674.1      8.197550       -0.187841  0.101419  -1.852129   
ENSG00000288675.1     32.370671       -0.652634  0.102204  -6.385618   

                          pvalue          padj  
ENSG00000000003.15  1.096424e-23  6.605189e-23  
ENSG00000000005.6   2.678385e-02  3.592073e-02  
ENSG00000000419.13  9.053625e-01  9.182818e-01  
ENSG00000000457.14  4.476050e-12  1.394755e-11  
ENSG00000000460.17  4.752078e-09  1.200628e-08  
...                          ...           ...  
ENSG00000288658.1   3.836546e-08  9.064050e-08  
ENSG00000288663.1   3.580819e-14  1.268982e-13  
ENSG00000288670.1   8.327492e-05  1.475736e-04  
ENSG00000288674.1   6.400724e-02  8.153584e-02  
ENSG00000288675.1   1.707070e-10  4.801086e-10  

[29995 rows x 6 columns]
Performing contrastive analysis for Normal vs. Basal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running Wald tests...
... done in 2.37 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log2 fold change &amp; Wald test p-value: paper_BRCA_Subtype_PAM50 Normal vs Basal
                       baseMean  log2FoldChange     lfcSE       stat  \
ENSG00000000003.15  3087.392130       -0.295840  0.161945  -1.826789   
ENSG00000000005.6     72.999641        0.192083  0.428710   0.448048   
ENSG00000000419.13  2386.496112       -0.555279  0.092278  -6.017474   
ENSG00000000457.14  1596.783158       -0.010172  0.093272  -0.109060   
ENSG00000000460.17   715.140714       -1.458786  0.119249 -12.233141   
...                         ...             ...       ...        ...   
ENSG00000288658.1     22.532026       -1.212750  0.353853  -3.427268   
ENSG00000288663.1     29.867524        0.482985  0.144510   3.342218   
ENSG00000288670.1    422.158728       -0.433294  0.117198  -3.697105   
ENSG00000288674.1      8.197550        0.187291  0.171522   1.091936   
ENSG00000288675.1     32.370671        0.012134  0.173117   0.070089   

                          pvalue          padj  
ENSG00000000003.15  6.773147e-02  1.155634e-01  
ENSG00000000005.6   6.541185e-01  7.328111e-01  
ENSG00000000419.13  1.771600e-09  1.772487e-08  
ENSG00000000457.14  9.131548e-01  9.377274e-01  
ENSG00000000460.17  2.067839e-34  5.743039e-32  
...                          ...           ...  
ENSG00000288658.1   6.096865e-04  1.915328e-03  
ENSG00000288663.1   8.311184e-04  2.519648e-03  
ENSG00000288670.1   2.180718e-04  7.638751e-04  
ENSG00000288674.1   2.748612e-01  3.696571e-01  
ENSG00000288675.1   9.441229e-01  9.600946e-01  

[29995 rows x 6 columns]
Fit type used for VST : parametric
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting dispersions...
... done in 9.63 seconds.
</pre></div>
</div>
<img alt="../../_images/f49901ee415f2d1167a5107857f61b8f6cf9b2bac11952798afedbff6d3c5816.png" src="../../_images/f49901ee415f2d1167a5107857f61b8f6cf9b2bac11952798afedbff6d3c5816.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Clearing gpu memory
Total = 42.4Gb 	 Reserved = 0.3Gb 	 Allocated = 0.3Gb
</pre></div>
</div>
<img alt="../../_images/014f71fbf9621706b1f4ecd20af8668d96d28838c63ec0219ae129ba034610cd.png" src="../../_images/014f71fbf9621706b1f4ecd20af8668d96d28838c63ec0219ae129ba034610cd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GCN_MME(
  (encoder_dims): ModuleList(
    (0): Encoder(
      (encoder): ModuleList(
        (0): Linear(in_features=464, out_features=500, bias=True)
        (1): Linear(in_features=500, out_features=16, bias=True)
      )
      (norm): ModuleList(
        (0): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=16, out_features=64, bias=True)
      )
      (drop): Dropout(p=0.5, inplace=False)
    )
    (1): Encoder(
      (encoder): ModuleList(
        (0): Linear(in_features=29995, out_features=500, bias=True)
        (1): Linear(in_features=500, out_features=16, bias=True)
      )
      (norm): ModuleList(
        (0): BatchNorm1d(500, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (1): BatchNorm1d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=16, out_features=64, bias=True)
      )
      (drop): Dropout(p=0.5, inplace=False)
    )
  )
  (gnnlayers): ModuleList(
    (0): GraphConv(in=64, out=32, normalization=both, activation=None)
    (1): GraphConv(in=32, out=5, normalization=both, activation=None)
  )
  (batch_norms): ModuleList(
    (0): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (drop): Dropout(p=0.5, inplace=False)
)
Graph(num_nodes=1076, num_edges=18346,
      ndata_schemes={&#39;idx&#39;: Scheme(shape=(), dtype=torch.int64), &#39;label&#39;: Scheme(shape=(5,), dtype=torch.int64), &#39;feat&#39;: Scheme(shape=(30459,), dtype=torch.float32)}
      edata_schemes={})
Epoch 00000 | Loss 1.8456 | Train Acc. 0.2435 | 
Epoch 00005 | Loss 0.5908 | Train Acc. 0.8030 | 
Epoch 00010 | Loss 0.5297 | Train Acc. 0.8197 | 
Epoch 00015 | Loss 0.5006 | Train Acc. 0.8178 | 
Epoch 00020 | Loss 0.4776 | Train Acc. 0.8327 | 
Epoch 00025 | Loss 0.4348 | Train Acc. 0.8494 | 
Epoch 00030 | Loss 0.4500 | Train Acc. 0.8309 | 
Epoch 00035 | Loss 0.4246 | Train Acc. 0.8364 | 
Epoch 00040 | Loss 0.4182 | Train Acc. 0.8439 | 
Epoch 00045 | Loss 0.4020 | Train Acc. 0.8532 | 
Epoch 00050 | Loss 0.3798 | Train Acc. 0.8439 | 
Epoch 00055 | Loss 0.4173 | Train Acc. 0.8439 | 
Epoch 00060 | Loss 0.3841 | Train Acc. 0.8625 | 
Epoch 00065 | Loss 0.3747 | Train Acc. 0.8532 | 
Epoch 00070 | Loss 0.3782 | Train Acc. 0.8550 | 
Epoch 00075 | Loss 0.3646 | Train Acc. 0.8662 | 
Epoch 00080 | Loss 0.3678 | Train Acc. 0.8513 | 
Epoch 00085 | Loss 0.3664 | Train Acc. 0.8550 | 
Epoch 00090 | Loss 0.3517 | Train Acc. 0.8717 | 
Epoch 00095 | Loss 0.3592 | Train Acc. 0.8606 | 
Epoch 00100 | Loss 0.3514 | Train Acc. 0.8606 | 
Epoch 00105 | Loss 0.3428 | Train Acc. 0.8625 | 
Epoch 00110 | Loss 0.3339 | Train Acc. 0.8680 | 
Epoch 00115 | Loss 0.3399 | Train Acc. 0.8699 | 
Epoch 00120 | Loss 0.3467 | Train Acc. 0.8699 | 
Epoch 00125 | Loss 0.3423 | Train Acc. 0.8755 | 
Epoch 00130 | Loss 0.3418 | Train Acc. 0.8680 | 
Epoch 00135 | Loss 0.3335 | Train Acc. 0.8792 | 
Epoch 00140 | Loss 0.3254 | Train Acc. 0.8755 | 
Epoch 00145 | Loss 0.3189 | Train Acc. 0.8755 | 
Epoch 00150 | Loss 0.3212 | Train Acc. 0.8736 | 
Epoch 00155 | Loss 0.3202 | Train Acc. 0.8717 | 
Epoch 00160 | Loss 0.3114 | Train Acc. 0.8736 | 
Epoch 00165 | Loss 0.3391 | Train Acc. 0.8736 | 
Epoch 00170 | Loss 0.3198 | Train Acc. 0.8755 | 
Epoch 00175 | Loss 0.3160 | Train Acc. 0.8717 | 
Epoch 00180 | Loss 0.3202 | Train Acc. 0.8736 | 
Epoch 00185 | Loss 0.3093 | Train Acc. 0.8829 | 
Epoch 00190 | Loss 0.3128 | Train Acc. 0.8736 | 
Epoch 00195 | Loss 0.3171 | Train Acc. 0.8829 | 
Epoch 00200 | Loss 0.2978 | Train Acc. 0.8792 | 
Epoch 00205 | Loss 0.3125 | Train Acc. 0.8625 | 
Epoch 00210 | Loss 0.3087 | Train Acc. 0.8885 | 
Epoch 00215 | Loss 0.3027 | Train Acc. 0.8829 | 
Epoch 00220 | Loss 0.2999 | Train Acc. 0.8829 | 
Epoch 00225 | Loss 0.3013 | Train Acc. 0.8848 | 
Epoch 00230 | Loss 0.2968 | Train Acc. 0.8903 | 
Epoch 00235 | Loss 0.3221 | Train Acc. 0.8848 | 
Epoch 00240 | Loss 0.3107 | Train Acc. 0.8773 | 
Epoch 00245 | Loss 0.2929 | Train Acc. 0.8959 | 
Epoch 00250 | Loss 0.2958 | Train Acc. 0.8792 | 
Epoch 00255 | Loss 0.2954 | Train Acc. 0.8848 | 
Epoch 00260 | Loss 0.2980 | Train Acc. 0.8922 | 
Epoch 00265 | Loss 0.3129 | Train Acc. 0.8810 | 
Epoch 00270 | Loss 0.3026 | Train Acc. 0.8829 | 
Epoch 00275 | Loss 0.2947 | Train Acc. 0.8866 | 
Epoch 00280 | Loss 0.3082 | Train Acc. 0.8829 | 
Epoch 00285 | Loss 0.3050 | Train Acc. 0.8792 | 
Epoch 00290 | Loss 0.3064 | Train Acc. 0.8680 | 
Epoch 00295 | Loss 0.3073 | Train Acc. 0.8755 | 
Epoch 00300 | Loss 0.3084 | Train Acc. 0.8792 | 
Epoch 00305 | Loss 0.2885 | Train Acc. 0.8978 | 
Epoch 00310 | Loss 0.2965 | Train Acc. 0.8829 | 
Epoch 00315 | Loss 0.3088 | Train Acc. 0.8662 | 
Epoch 00320 | Loss 0.3027 | Train Acc. 0.8903 | 
Epoch 00325 | Loss 0.3060 | Train Acc. 0.8848 | 
Epoch 00330 | Loss 0.3038 | Train Acc. 0.8885 | 
Epoch 00335 | Loss 0.3032 | Train Acc. 0.8736 | 
Epoch 00340 | Loss 0.2948 | Train Acc. 0.8810 | 
Epoch 00345 | Loss 0.3166 | Train Acc. 0.8810 | 
Epoch 00350 | Loss 0.3035 | Train Acc. 0.8885 | 
Epoch 00355 | Loss 0.2869 | Train Acc. 0.8959 | 
Epoch 00360 | Loss 0.3090 | Train Acc. 0.8810 | 
Epoch 00365 | Loss 0.3108 | Train Acc. 0.8848 | 
Epoch 00370 | Loss 0.3101 | Train Acc. 0.8848 | 
Epoch 00375 | Loss 0.3036 | Train Acc. 0.8773 | 
Epoch 00380 | Loss 0.2995 | Train Acc. 0.8829 | 
Epoch 00385 | Loss 0.3024 | Train Acc. 0.8848 | 
Epoch 00390 | Loss 0.2995 | Train Acc. 0.8848 | 
Epoch 00395 | Loss 0.2863 | Train Acc. 0.8922 | 
Epoch 00400 | Loss 0.2827 | Train Acc. 0.9052 | 
Epoch 00405 | Loss 0.2953 | Train Acc. 0.8773 | 
Epoch 00410 | Loss 0.2914 | Train Acc. 0.8773 | 
Epoch 00415 | Loss 0.2812 | Train Acc. 0.8959 | 
Epoch 00420 | Loss 0.2828 | Train Acc. 0.8829 | 
Early stopping! No improvement for 100 consecutive epochs.
</pre></div>
</div>
<img alt="../../_images/1088e3437251ae6ff9db4f178b57ee8bb2d55cc73d40e385744c5c53b697a9e8.png" src="../../_images/1088e3437251ae6ff9db4f178b57ee8bb2d55cc73d40e385744c5c53b697a9e8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fold : 2 | Test Accuracy = 0.8290 | F1 = 0.7999 
Total = 42.4Gb 	 Reserved = 0.8Gb 	 Allocated = 0.4Gb
Clearing gpu memory
Total = 42.4Gb 	 Reserved = 0.3Gb 	 Allocated = 0.3Gb
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">output_metrics</span> <span class="p">:</span>
    
    <span class="n">accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%i</span><span class="s2"> Fold Cross Validation Accuracy = </span><span class="si">%2.2f</span><span class="s2"> </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">%2.2f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="mi">5</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%i</span><span class="s2"> Fold Cross Validation F1 = </span><span class="si">%2.2f</span><span class="s2"> </span><span class="se">\u00B1</span><span class="s2"> </span><span class="si">%2.2f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="mi">5</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>

<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">test_logits</span> <span class="p">,</span> <span class="n">test_labels</span> <span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Test Accuracy = </span><span class="si">%2.1f</span><span class="s1"> </span><span class="si">%%</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>

<span class="n">precision_recall_plot</span> <span class="p">,</span> <span class="n">all_predictions_conf</span> <span class="o">=</span> <span class="n">AUROC</span><span class="p">(</span><span class="n">test_logits</span><span class="p">,</span> <span class="n">test_labels</span> <span class="p">,</span> <span class="n">meta</span><span class="p">)</span>

<span class="n">node_predictions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">true_label</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">display_label</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span>

<span class="k">for</span> <span class="n">pred</span> <span class="p">,</span> <span class="n">true</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_predictions_conf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">test_labels</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>  <span class="p">:</span> 
    <span class="n">node_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">display_label</span><span class="p">[</span><span class="n">pred</span><span class="p">])</span>
    <span class="n">true_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">display_label</span><span class="p">[</span><span class="n">true</span><span class="o">.</span><span class="n">item</span><span class="p">()])</span>

<span class="n">preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Actual&#39;</span> <span class="p">:</span> <span class="n">true_label</span> <span class="p">,</span> <span class="s1">&#39;Predicted&#39;</span> <span class="p">:</span> <span class="n">node_predictions</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 Fold Cross Validation Accuracy = 83.27 ¬± 0.37
5 Fold Cross Validation F1 = 80.19 ¬± 0.20
</pre></div>
</div>
<img alt="../../_images/21770708103173363f8d9b39d40b045113546bc2aec748772f7896badb0faf9f.png" src="../../_images/21770708103173363f8d9b39d40b045113546bc2aec748772f7896badb0faf9f.png" />
<img alt="../../_images/6a1e0908e050849ac549502897ceed861b668af3ec45f751caea7cdfb9d101dc.png" src="../../_images/6a1e0908e050849ac549502897ceed861b668af3ec45f751caea7cdfb9d101dc.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./MOGDx\Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="MOGDx_PNet.html" class="btn btn-neutral float-left" title="MOGDx &amp; PNet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="MOGDx_Free.html" class="btn btn-neutral float-right" title="MOGDx Free" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z09VV2YFE0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-Z09VV2YFE0', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>